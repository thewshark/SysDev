MS45CLI2Supplier.ActiveParty=1  and PartyAddress.AddressID=0%DEFAULT%.'F.'++(cast(Supplier.SupplierID as varchar))#Supplier.OrganizationName#PartyAddress.AddressLine1#PartyAddress.AddressLine2#%DEFAULT%.left((select case when ISNUMERIC(SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4))=1 
		and SUBSTRING(PostalCode,CHARINDEX(SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4),PostalCode,1)+4,1)<>'-' 
		and ISNUMERIC(SUBSTRING(PostalCode,CHARINDEX(SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4),PostalCode,1)+4,3))=0 
	 then replace(PostalCode,SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4),SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4) + '-000') 
	 else PostalCode end),8)#%DEFAULT%.REPLACE(Supplier.FederalTaxID, ' ','')#%DEFAULT%.'N'#%DEFAULT%.0##%DEFAULT%.0#Supplier.Telephone1#Supplier.MobileTelephone1#Supplier.Fax#Supplier.ZoneID#Supplier.PaymentID#Supplier.EmailAddress#Supplier.Comments#Supplier.DirectDiscount#%DEFAULT%.0#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#PartyBankAccount.AccountNumber#%DEFAULT%.'N'#%DEFAULT%.'N'#%DEFAULT%.0#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.'N'#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.''#%DEFAULT%.0#%DEFAULT%.0#%DEFAULT%.0#%DEFAULT%.0#%DEFAULT%.0#%DEFAULT%.'F'#%DEFAULT%.''#########%DEFAULT%.concat(Supplier.EntityFiscalStatusID,'.',zone.CountryID,'.',Zone.TaxRegionID)#############%DEFAULT%.0#%DEFAULT%.0#Supplier.CreateDate#%DEFAULT%.''#%DEFAULT%.'N'##CountryCodes.ISOCountryID#Person.Name###%DEFAULT%.(Select CASE when Supplier.AplyRetentionTax = 1 then 'S' else 'N' end)+'[SEPACL][SEPACL][SEPACL]'+(select case when Supplier.TaxablePersonType=2 then 'S' when Supplier.TaxablePersonType=1 then 'N' else '' end)+'[SEPACL]'+(case when Supplier.CashAccountingSchemeSignIn > getdate() then 'N' 
when Supplier.CashAccountingSchemeSignIn < getdate() and Supplier.CashAccountingSchemeSignOut is null then 'S' 
when Supplier.CashAccountingSchemeSignOut > getdate() then 'N' 
when getdate() between Supplier.CashAccountingSchemeSignIn and Supplier.CashAccountingSchemeSignOut then 'S'
else 'N' end)+'[SEPACL]'+(case when Supplier.EntityFiscalStatusID = 2 then 'S' else 'N' end)+'[SEPACL]'+(select case when Supplier.EntityFiscalStatusID = 2 then 
(select TaxExemptionReason from TaxTable (nolock) where TaxGroupid='IVA' and TaxSequenceID=4 and TaxRate=0 and countryid=Zone.CountryID and TaxRegionID=Zone.TaxRegionID) else '' end)+'[SEPACL]'+(select case when Supplier.EntityFiscalStatusID = 2 then 
(select TaxExemptionReasonCode from TaxTable (nolock) where TaxGroupid='IVA' and TaxSequenceID=4 and TaxRate=0 and countryid=Zone.CountryID and TaxRegionID=Zone.TaxRegionID) else '' end)Supplier.DtAlt@JOIN@PartyAddress@ON@Supplier.PartyID=PartyAddress.PartyID@LEFT@CountryCodes@ON@CountryCodes.CountryID=PartyAddress.CountryID@LEFT@Person@ON@Supplier.PartyID=Person.PartyID@LEFT@PartyBankAccount@ON@Supplier.PartyID=PartyBankAccount.PartyID@JOIN@Zone@ON@Supplier.ZoneID=Zone.ZoneIDSupplier0SELECT 'F.'++(cast(Supplier.SupplierID as varchar)), Supplier.OrganizationName, PartyAddress.AddressLine1, PartyAddress.AddressLine2, left((select case when ISNUMERIC(SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4))=1 
		and SUBSTRING(PostalCode,CHARINDEX(SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4),PostalCode,1)+4,1)<>'-' 
		and ISNUMERIC(SUBSTRING(PostalCode,CHARINDEX(SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4),PostalCode,1)+4,3))=0 
	 then replace(PostalCode,SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4),SUBSTRING(PostalCode,(PATINDEX('%[0-9]%',PostalCode)),4) + '-000') 
	 else PostalCode end),8), REPLACE(Supplier.FederalTaxID, ' ',''), 'N', 0, 0, 0, Supplier.Telephone1, Supplier.MobileTelephone1, Supplier.Fax, Supplier.ZoneID, Supplier.PaymentID, Supplier.EmailAddress, Supplier.Comments, Supplier.DirectDiscount, 0, '', '', '', PartyBankAccount.AccountNumber, 'N', 'N', 0, '', '', '', '', '', '', '', 'N', '', '', '', '', '', '', '', 0, 0, 0, 0, 0, 'F', '', '', '', '', '', '', '', '', '', concat(Supplier.EntityFiscalStatusID,'.',zone.CountryID,'.',Zone.TaxRegionID), '', '', '', '', '', '', '', '', '', '', '', '', 0, 0, Supplier.CreateDate, '', 'N', '', CountryCodes.ISOCountryID, Person.Name, '', '', (Select CASE when Supplier.AplyRetentionTax = 1 then 'S' else 'N' end)+'[SEPACL][SEPACL][SEPACL]'+(select case when Supplier.TaxablePersonType=2 then 'S' when Supplier.TaxablePersonType=1 then 'N' else '' end)+'[SEPACL]'+(case when Supplier.CashAccountingSchemeSignIn > getdate() then 'N' 
when Supplier.CashAccountingSchemeSignIn < getdate() and Supplier.CashAccountingSchemeSignOut is null then 'S' 
when Supplier.CashAccountingSchemeSignOut > getdate() then 'N' 
when getdate() between Supplier.CashAccountingSchemeSignIn and Supplier.CashAccountingSchemeSignOut then 'S'
else 'N' end)+'[SEPACL]'+(case when Supplier.EntityFiscalStatusID = 2 then 'S' else 'N' end)+'[SEPACL]'+(select case when Supplier.EntityFiscalStatusID = 2 then 
(select TaxExemptionReason from TaxTable (nolock) where TaxGroupid='IVA' and TaxSequenceID=4 and TaxRate=0 and countryid=Zone.CountryID and TaxRegionID=Zone.TaxRegionID) else '' end)+'[SEPACL]'+(select case when Supplier.EntityFiscalStatusID = 2 then 
(select TaxExemptionReasonCode from TaxTable (nolock) where TaxGroupid='IVA' and TaxSequenceID=4 and TaxRate=0 and countryid=Zone.CountryID and TaxRegionID=Zone.TaxRegionID) else '' end) FROM Supplier(nolock) JOIN PartyAddress (NOLOCK) ON Supplier.PartyID=PartyAddress.PartyID LEFT JOIN CountryCodes (NOLOCK) ON CountryCodes.CountryID=PartyAddress.CountryID LEFT JOIN Person (NOLOCK) ON Supplier.PartyID=Person.PartyID LEFT JOIN PartyBankAccount (NOLOCK) ON Supplier.PartyID=PartyBankAccount.PartyID JOIN Zone (NOLOCK) ON Supplier.ZoneID=Zone.ZoneID WHERE () AND Supplier.ActiveParty=1  and PartyAddress.AddressID=0
